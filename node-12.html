
<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8" />
<meta name="author" content="RÃ©mi Flamary" />
<meta name="generator" content="LaTeX Lwarp package" />
<meta name="description" content="Lecture notes for MAP555 :      Signal Processing" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<!--[if lt IE 9]>
<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<title>MAP555 : Signal Processing</title>
<link rel="stylesheet" type="text/css" href="map555.css" />



<!-- https://groups.google.com/forum/#!topic/
                                       mathjax-users/jUtewUcE2bY -->
<script type="text/x-mathjax-config">
MathJax.Hub.Register.StartupHook("TeX AMSmath Ready",function () {
      var seteqsectionDefault = {name: "", num: 0};
      var seteqsections = {}, seteqsection = seteqsectionDefault;
      var TEX = MathJax.InputJax.TeX, PARSE = TEX.Parse;
      var AMS = MathJax.Extension["TeX/AMSmath"];
      TEX.Definitions.Add({
      macros: {
            seteqsection: "mySection",
            seteqnumber: "mySetEqNumber"
      }
      });


      PARSE.Augment({
      mySection: function (name) {
            seteqsection.num = AMS.number;
            var n = this.GetArgument(name);
            if (n === "") {
                seteqsection = seteqsectionDefault;
            } else {
                if (!seteqsections["_"+n])
                     seteqsections["_"+n] = {name:n, num:0};
                seteqsection = seteqsections["_"+n];
            }
            AMS.number = seteqsection.num;
      },
      mySetEqNumber: function (name) {
            var n = this.GetArgument(name);
            if (!n || !n.match(/^ *[0-9]+ *$/))
                n = "";
            else
                n = parseInt(n)-1;
            <!-- $ syntax highlighting -->
            if (n === "" || n < 1)
                TEX.Error
                ("Argument to "+name+" should be a positive integer");
            AMS.number = n;
      }
      });
      MathJax.Hub.Config({
      TeX: {
            equationNumbers: {
                formatTag: function (n) {
                     <!-- if not numeric, don't include the chapter -->
                     if (!n.match(/^ *[0-9]+ *$/ ))
                     <!-- $ syntax highlighting -->
                            return "("+(n).replace(/^\./,"")+")" ;
                     else
                            return "("+(seteqsection.name+"."+n).replace(/^\./,"")+")" ;
                },
                formatID: function (n) {
                     n = (seteqsection.name+'.'+n).replace
                            (/[:"'<>&]/g,"").replace(/^\./,"");
                     return 'mjx-eqn-' + n;
                }
            }
      }
      });
});
</script>


<!-- http://docs.mathjax.org/en/latest/options/ThirdParty.html -->
<script type="text/x-mathjax-config">
  MathJax.Ajax.config.path["Contrib"] =
      "https://cdn.mathjax.org/mathjax/contrib";
</script>


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
      TeX: {
            extensions: ["autoload-all.js"] ,
            equationNumbers: {
                autoNumber: "AMS"
            }
      }
});
</script>


<!-- Alternative CDN provider: -->
<script type="text/javascript" async
src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS_HTML-full">
</script>


<!-- No longer supported after April 30, 2017: -->
<!--
<script
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML-full">
</script>
-->
 <script type="text/javascript"
   src="navigation.js">
   </script>



</head>
<body>


<a id="poly-autopage-189"></a>
<nav class="topnavigation" ><a href="index.html" class="linkhome" >
Home</a></nav>


<div class="bodyandsidetoc" >
<div class="sidetoccontainer" >


<nav class="sidetoc" >


<div class="sidetoctitle" >

<p>
<span class="sidetocthetitle" >MAP555 : Signal Processing </span>
</p>

<p>
Contents
</p>
</div>


<div class="sidetoccontents" >

<p>
<a href="index.html" class="linkhome" >
Home</a>
</p>

<p>
<a href="node-1.html#autosec-6" class="tocchapter" >
<span class="sectionnumber" >1</span>&#x2003;Introduction</a>
</p>


<p>
<a href="node-1.html#autosec-7" class="tocsection" >
<span class="sectionnumber" >1.1</span>&#x2003;Signal processing</a>
</p>


<p>
<a href="node-2.html#autosec-12" class="tocsection" >
<span class="sectionnumber" >1.2</span>&#x2003;Bibliographical notes</a>
</p>


<p>
<a href="node-3.html#autosec-19" class="tocsection" >
<span class="sectionnumber" >1.3</span>&#x2003;About this document</a>
</p>


<p>
<a href="node-4.html#autosec-21" class="tocchapter" >
<span class="sectionnumber" >2</span>&#x2003;Signals and convolution</a>
</p>


<p>
<a href="node-4.html#autosec-22" class="tocsection" >
<span class="sectionnumber" >2.1</span>&#x2003;Signals and properties</a>
</p>


<p>
<a href="node-5.html#autosec-47" class="tocsection" >
<span class="sectionnumber" >2.2</span>&#x2003;Convolution and filtering</a>
</p>


<p>
<a href="node-6.html#autosec-57" class="tocsection" >
<span class="sectionnumber" >2.3</span>&#x2003;Discrete time and digital signals</a>
</p>


<p>
<a href="node-7.html#autosec-80" class="tocsection" >
<span class="sectionnumber" >2.4</span>&#x2003;Fundamental signal processing problems</a>
</p>


<p>
<a href="node-8.html#autosec-85" class="tocchapter" >
<span class="sectionnumber" >3</span>&#x2003;Fourier analysis and analog filtering</a>
</p>


<p>
<a href="node-9.html#autosec-88" class="tocsection" >
<span class="sectionnumber" >3.1</span>&#x2003;Fourier series</a>
</p>


<p>
<a href="node-10.html#autosec-97" class="tocsection" >
<span class="sectionnumber" >3.2</span>&#x2003;Fourier transform</a>
</p>


<p>
<a href="node-11.html#autosec-133" class="tocsection" >
<span class="sectionnumber" >3.3</span>&#x2003;Frequency response and filtering</a>
</p>


<p>
<a href="node-12.html#autosec-190" class="tocsection" >
<span class="sectionnumber" >3.4</span>&#x2003;Applications of analog signal processing</a>
</p>


<p>
<a href="node-13.html#autosec-248" class="tocchapter" >
<span class="sectionnumber" >4</span>&#x2003;Digital signal processing</a>
</p>


<p>
<a href="node-13.html#autosec-249" class="tocsection" >
<span class="sectionnumber" >4.1</span>&#x2003;Sampling and Analog/Digital conversion</a>
</p>


<p>
<a href="node-14.html#autosec-251" class="tocsection" >
<span class="sectionnumber" >4.2</span>&#x2003;Digital filtering and transfer function</a>
</p>


<p>
<a href="node-15.html#autosec-253" class="tocsection" >
<span class="sectionnumber" >4.3</span>&#x2003;Finite signals and Fast Fourier Transform</a>
</p>


<p>
<a href="node-16.html#autosec-255" class="tocsection" >
<span class="sectionnumber" >4.4</span>&#x2003;Applications of DSP</a>
</p>


<p>
<a href="node-17.html#autosec-257" class="tocchapter" >
<span class="sectionnumber" >5</span>&#x2003;Random signals</a>
</p>


<p>
<a href="node-17.html#autosec-258" class="tocsection" >
<span class="sectionnumber" >5.1</span>&#x2003;Random Signals and Correlations</a>
</p>


<p>
<a href="node-18.html#autosec-260" class="tocsection" >
<span class="sectionnumber" >5.2</span>&#x2003;Frequency representation of random signals</a>
</p>


<p>
<a href="node-19.html#autosec-262" class="tocsection" >
<span class="sectionnumber" >5.3</span>&#x2003;AR modeling and linear prediction</a>
</p>


<p>
<a href="node-20.html#autosec-264" class="tocchapter" >
<span class="sectionnumber" >6</span>&#x2003;Signal representations</a>
</p>


<p>
<a href="node-20.html#autosec-265" class="tocsection" >
<span class="sectionnumber" >6.1</span>&#x2003;Short Time Fourier Transform</a>
</p>


<p>
<a href="node-21.html#autosec-267" class="tocsection" >
<span class="sectionnumber" >6.2</span>&#x2003;Common signal representations</a>
</p>


<p>
<a href="node-22.html#autosec-269" class="tocsection" >
<span class="sectionnumber" >6.3</span>&#x2003;Source separation and dictionary learning</a>
</p>


<p>
<a href="node-23.html#autosec-271" class="tocsection" >
<span class="sectionnumber" >6.4</span>&#x2003;Machine learning for signal processing</a>
</p>


<p>
<a href="node-24.html#autosec-273" class="tocchapter" >
Bibliography</a>
</p>


<p>
<a href="node-25.html#autosec-276" class="tocchapter" >
Index</a>
</p>


</div>

</nav>

</div>


<div class="bodycontainer" >


<section class="textbody" >

<h1></h1>

<!--MathJax customizations:-->


<div class="hidden" >

\(\newcommand \ensuremath [1]{#1}\)

\(\newcommand \footnote [2][]{\text {( Footnote #1 )}}\)

\(\newcommand \footnotemark [1][]{\text {( Footnote #1 )}}\)

\(\newcommand {\LWRframebox }[2][]{\fbox {#2}} \newcommand {\framebox }[1][]{\LWRframebox } \)

\(\newcommand {\setlength }[2]{}\)

\(\newcommand {\addtolength }[2]{}\)

\(\newcommand {\setcounter }[2]{}\)

\(\newcommand {\addtocounter }[2]{}\)

\(\newcommand {\cline }[1]{}\)

\(\newcommand {\directlua }[1]{\text {(directlua)}}\)

\(\newcommand {\luatexdirectlua }[1]{\text {(directlua)}}\)

\(\newcommand {\intertext }[1]{\\ \text {#1}\notag \\}\)

\(\newcommand {\Sh }{{III}}\)

\(\newcommand {\dbR }{{\mathbb {R}}}\)

\(\newcommand {\R }{{\mathbb {R}}}\)

\(\newcommand {\dbC }{{\mathbb {C}}}\)

\(\newcommand {\u }{{\mathbf {u}}}\)

\(\newcommand {\v }{{\mathbf {v}}}\)

\(\newcommand {\x }{{\mathbf {x}}}\)

\(\newcommand {\h }{{\mathbf {h}}}\)

\(\newcommand {\y }{{\mathbf {y}}}\)

\(\newcommand {\C }{{\mathbf {C}}}\)

\(\newcommand {\H }{{\mathbf {H}}}\)

\(\newcommand {\p }{{\mathbf {p}}}\)

\(\newcommand {\rme }{{e}}\)

\(\newcommand {\rmd }{{d}}\)

\(\newcommand {\rmi }{{i}}\)

\(\newcommand {\ostar }{{{\mbox {$\;\odot \!\!\!\!\!\star ~$}}}}\)

\(\newcommand {\pause }{{ }}\)

</div>

<p>
<h4 id="autosec-190"><span class="sectionnumber" >3.4&#x2003;</span>Applications of analog signal processing</h4>
<a id="poly-autopage-190"></a>
<a id="sec:appli-ft"></a>
<p>
<span class="paragraph" id="autosec-191">Applications of analog signal processing</span>
<a id="poly-autopage-191"></a>

</p>
<ul style="list-style-type:none">

<li>
<p>
â€¢ Analog signal filtering.
</p>
<ul style="list-style-type:none">


<li>
<p>
â€“ Electronic passive and active filters.
</p>


</li>
<li>
<p>
â€“ Modeling and filtering with physical systems.
</p>
</li>
</ul>
</li>
<li>
<p>
â€¢ Telecommunications.
</p>
<ul style="list-style-type:none">


<li>
<p>
â€“ Amplitude modulation.
</p>


</li>
<li>
<p>
â€“ Multiplexing.
</p>
</li>
</ul>
</li>
<li>
<p>
â€¢ Fourier opticsL
</p>
<ul style="list-style-type:none">


<li>
<p>
â€“ Light propagation in perfect lens/mirror systems.
</p>


</li>
<li>
<p>
â€“ Point spread functions of telescope and cameras.
</p>
</li>
</ul>
</li>
</ul>
<h5 id="autosec-192"><span class="sectionnumber" >3.4.1&#x2003;</span>Analog filtering</h5>
<a id="poly-autopage-192"></a>


<a id="sec:analogfiltering"></a>
<h6 id="autosec-193"><span class="sectionnumber" >3.4.1.1&#x2003;</span>Properties of analog filters</h6>
<a id="poly-autopage-193"></a>
<p>
<span class="paragraph" id="autosec-194">Definition</span>
<a id="poly-autopage-194"></a>
Signal processing system that aim at selecting part of the signal and attenuating another part (noise).
</p>

<p>
Analog filtering as opposed to digital filtering (next course)
</p>
<p>
<span class="paragraph" id="autosec-195">Objectives</span>
<a id="poly-autopage-195"></a>

</p>
<ul style="list-style-type:none">

<li>
<p>
â€¢ Find a system that transform a signal \(x(t)\) to extract pertinent information.
</p>


</li>
<li>
<p>
â€¢ Attenuate noise in a signal.
</p>


</li>
<li>
<p>
â€¢ Separate several components of a signal (when different frequency bands).
</p>
</li>
</ul>
<p>
<span class="paragraph" id="autosec-196">Filtering and bandwidth</span>
<a id="poly-autopage-196"></a>

</p>
<p>
<span class="paragraph" id="autosec-197">Gain and Attenuation</span>
<a id="poly-autopage-197"></a>

</p>

<ul style="list-style-type:none">

<li>
<p>
â€¢ In order to characterize a filter one uses its Gain/Phase (Bode plot).
</p>
<p>
\[\tilde G_{DB}(w)=20\log _{10}(|\tilde H(w)|)\quad \text {et}\quad \tilde \Phi (w)=Arg(\tilde H(w))\]
</p>
</li>
<li>
<p>
â€¢ Attenuation is also often used \(\tilde A(w)=-\tilde G_{DB}(w)\)
</p>
</li>
</ul>
<p>
<span class="paragraph" id="autosec-198">Bandwith and passband</span>
<a id="poly-autopage-198"></a>
The band with of a filter is the set of frequency for which the Gain is over a reference (usually -3dB). Bandwith at \(-3dB\):
</p>

<p>
<span class="hidden" > \( \seteqsection {3} \) </span>      <span class="hidden" > \( \seteqnumber {23} \) </span>
</p>
<!--

                                                                                                                                                                    
                                                                                                                                               |HÌƒ(w)|
                                                                                                                   BW =       w|20 log                          â‰¥ âˆ’3
                                                                                                                                             max(|HÌƒ(w)|)

-->

<p>

\begin{equation*} BW= \left \{w|20\log \left (\frac {|\tilde H(w)|}{\max (|\tilde H(w)|)}\right )\geq -3\right \} \end{equation*}

</p>
<p>
<span class="paragraph" id="autosec-199">Types of filters</span>
<a id="poly-autopage-199"></a>

</p>
<ul style="list-style-type:none">

<li>
<p>
â€¢ <b>Low-pass</b>, \(BW=[O,f_c]\) with \(f_c\) cutoff frequency
</p>


</li>
<li>
<p>
â€¢ <b>High-pass</b>, \(BW=[f_c,\infty ]\)
</p>


</li>
<li>
<p>
â€¢ <b>Band-pass</b>, \(BW=[f_{c_1},f_{c_2}]\)
</p>


</li>
<li>
<p>
â€¢ <b>Band-stop</b>, \(BW=[0,f_{c_1}]\cup [f_{c_2},\infty ]\)
</p>
</li>
</ul>
<p>
<span class="paragraph" id="autosec-200">Filter distortion</span>
<a id="poly-autopage-200"></a>

</p>
<p>
<span class="paragraph" id="autosec-201">Undistorted transmission</span>
<a id="poly-autopage-201"></a>
A signal is considered undistorted when the output of the system is
</p>

<p>
\[y(t)=Cx(t-t_0)\]
</p>

<p>
With
</p>
<ul style="list-style-type:none">

<li>
<p>
â€¢ \(C\) a constant gain.
</p>


</li>
<li>
<p>
â€¢ \(t_0&gt;0\) is a delay.
</p>
</li>
</ul>

<p>
A system with no distortion has the following FT and impulse response
</p>

<p>
\[\tilde H(w)=\frac {\tilde X(w)}{\tilde Y(w)}={Ce^{-jwt_0}} \quad \text {et} \quad h(t)={C\delta (t-t_0)}\]
</p>

<p>
With
</p>
<ul style="list-style-type:none">

<li>
<p>
â€¢ \(|\tilde H(w)|=C\) or else amplitude distortion.
</p>


</li>
<li>
<p>
â€¢ \(Arg(\tilde H(w))=-wt_0\) or else phase distortion.
</p>
</li>
</ul>

<p>
Note that the argument of the frequency response varies linearly with the frequency.
</p>
<div class="center" >

<p>

<a href="imgs/fourier/distortion.svg" target="_blank" ><img
    src="imgs/fourier/distortion.svg"
    style="
    width:173pt;
    "
    class="inlineimage"
    alt="(image)"
></a>
</p>
</div>
<p>
<span class="paragraph" id="autosec-203">Phase distortion</span>
<a id="poly-autopage-203"></a>
Let a system of frequency response
</p>

<p>
\[\tilde H(w)=|H(w)|e^{j\phi (w)}\]
</p>

<p>
We can deduce that for
</p>
<span class="hidden" > \( \seteqsection {3} \) </span>   <span class="hidden" > \( \seteqnumber {23} \) </span>
<!--


                                                                                                   x(t) = cos(Ï‰t)
                                                                                                   y(t) = |HÌƒ(Ï‰)| cos(Ï‰t + Ï†(Ï‰)) = |HÌƒ(Ï‰)| cos(Ï‰(t + Ï†(Ï‰)/Ï‰))


-->


<p>

\begin{align*} x(t)&amp;=\cos (\omega t)\\ y(t)&amp;=|\tilde H(\omega )| \cos (\omega t+ \phi (\omega ))=|\tilde H(\omega )| \cos (\omega (t+ \phi (\omega )/\omega )) \end{align*}
The delay \(\phi (\omega )/\omega \) is also called <b>propagation time</b> of <b>frequency delay</b>. For it to be independent from frequency it is necessary that
</p>

<p>
\[\frac {\phi (\omega )}{\omega }=cte=\tau \quad \rightarrow \quad \phi (\omega )=\omega \tau \]
</p>
<p>
<span class="paragraph" id="autosec-204">Ideal low pass filter</span>
<a id="poly-autopage-204"></a>

</p>
<p>
<span class="paragraph" id="autosec-205">Definition</span>
<a id="poly-autopage-205"></a>

</p>
<ul style="list-style-type:none">

<li>
<p>
â€¢ The ideal low-pass filter is often a theoretical object in signal processing.
</p>


</li>
<li>
<p>
â€¢ Perfect to use when the noise and signal have non-overlapping spectra.
</p>


</li>
<li>
<p>
â€¢ The frequency response of the ideal filter is
</p>
<p>
\[ H(f)= \left \{ \begin {array}{ll} 1 &amp; \text { if } |f| &lt; f_c \\ 0 &amp; \text { else} \end {array} \right . \]
</p>
<p>
where \(f_c\) is the cutoff frequency.
</p>


</li>
<li>
<p>
â€¢ The impulse response of the filter is
</p>
<p>
<span class="hidden" > \( \seteqsection {3} \) </span>         <span class="hidden" > \( \seteqnumber {23} \) </span>
</p>
<!--

                                                                                                                                  sin(2Ï€fc t)
                                                                                                                     h(t) = 2fc               = 2fc sinc(2Ï€fc t)
                                                                                                                                     2Ï€fc t

-->
<p>


\begin{equation*} h(t)={2f_c\frac {\sin (2\pi f_c t)}{2\pi f_ct}=2f_c\text {sinc}(2\pi f_ct)} \end{equation*}


</p>
<p>


</p>
</li>
</ul>
<p>
<span class="paragraph" id="autosec-206">Realizable filter</span>
<a id="poly-autopage-206"></a>

</p>
<ul style="list-style-type:none">

<li>
<p>
â€¢ A realizable temporal filter is <b>causal</b> and <b>stable</b> (absolute integrable).
</p>


</li>
<li>
<p>
â€¢ Ideal filter is neither of those and cannot be used for 1D (time) filtering.
</p>


</li>
<li>
<p>
â€¢ For images (2D) causality is not necessary.
</p>
</li>
</ul>
<h6 id="autosec-207"><span class="sectionnumber" >3.4.1.2&#x2003;</span>Filter design</h6>
<a id="poly-autopage-207"></a>
<p>
<span class="paragraph" id="autosec-208">Real filter</span>
<a id="poly-autopage-208"></a>

</p>
<ul style="list-style-type:none">

<li>
<p>
â€¢ Ideal filters are non causal and cannot be implemented in practice .
</p>


</li>
<li>
<p>
â€¢ We search for an approximation of the ideal filter.
</p>


</li>
<li>
<p>
â€¢ the approximation has to respect <b>constraints</b> (Gabarit in french).
</p>
</li>
</ul>
<p>
<span class="paragraph" id="autosec-209">Constraints of a filter</span>
<a id="poly-autopage-209"></a>

</p>
<div class="center" >
<div class="center" >

<p>

<a href="imgs/fourier/gabarit3.svg" target="_blank" ><img
    src="imgs/fourier/gabarit3.svg"
    style="
    width:217pt;
    "
    class="inlineimage"
    alt="(image)"
></a>
</p>
</div>

</div>
<p>
<span class="paragraph" id="autosec-212">Parameters:</span>
<a id="poly-autopage-212"></a>

</p>
<ul style="list-style-type:none">

<li>
<p>
â€¢ Bandwidth \(BW\) and rejected band:
</p>
<ul style="list-style-type:none">


<li>
<p>
â€“ \(w_c\) cutoff frequency
</p>


</li>
<li>
<p>
â€“ \(w_a\) attenuation frequency
</p>
</li>
</ul>
</li>
<li>
<p>
â€¢ Oscillations :
</p>
<ul style="list-style-type:none">


<li>
<p>
â€“ \(\varepsilon \) in passing bandwidth
</p>


</li>
<li>
<p>
â€“ \(\delta \) in attenuated bandwidth
</p>
</li>
</ul>
</li>
</ul>

<p>
The constraints define the transfer function area that are acceptable for a given application.

<p>

</p>
<p>
<span class="paragraph" id="autosec-213">Simple example of filter design</span>
<a id="poly-autopage-213"></a>

</p>
<ul style="list-style-type:none">

<li>
<p>
â€¢ Application to Brain computer interface.
</p>


</li>
<li>
<p>
â€¢ Interesting signal for event related potentials below \(\approx 12\)Hz (\(w_s=2\pi *12\)).
</p>


</li>
<li>
<p>
â€¢ Electrical noise (EDF) at \(50\)Hz (\(w_{edf}=2\pi *50\)).
</p>


</li>
<li>
<p>
â€¢ Two low power signals \(A_s\approx A_n\).
</p>


</li>
<li>
<p>
â€¢ Maximum attenuation of signal at -3dB.
</p>


</li>
<li>
<p>
â€¢ Filtering with first order filter.
</p>
</li>
</ul>

<p>
5cm
</p>
<div class="center" >

<p>

<a href="imgs/fourier/RC2.svg" target="_blank" ><img
    src="imgs/fourier/RC2.svg"
    style="
    width:405pt;
    "
    class="inlineimage"
    alt="(image)"
></a>
</p>
</div>

<ul style="list-style-type:none">

<li>
<p>
â€¢ Frequency response
</p>
<p>
\[ \tilde H(w)=\frac {1}{1+j\frac {w}{w_0}} \]
</p>
</li>
<li>
<p>
â€¢ Gain in Db
</p>
<p>
<span class="hidden" > \( \seteqsection {3} \) </span>   <span class="hidden" > \( \seteqnumber {23} \) </span>
</p>
<!--
                                                                                                                                                    
                                                                                                                                               w2
                                                                                                                  GÌƒ(w) = âˆ’10 log10       1+
                                                                                                                                               w02

-->
<p>


\begin{equation*} \tilde G(w)={-10\log _{10}\left (1+\frac {w^2}{w_0^2}\right )} \end{equation*}


</p>
<p>


</p>
</li>
</ul>

<ul style="list-style-type:none">

<li>
<p>
â€¢ Before filtering: SNR\(=20\log _{10}\left (\frac {A_s}{A_n}\right )=\pause {0}\)
</p>


</li>
<li>
<p>
â€¢ After filtering :
</p>
<p>
SNR\(=\pause G(w_s)-G(w_{edf})\)
</p>
</li>
<li>
<p>
â€¢ Choice of \(w_0\)?
</p>
</li>
</ul>

<ul style="list-style-type:none">

<li>
<p>
â€¢ SNR\(=\tilde G(w_s)-\tilde G(w_{edf})\)
</p>


</li>
<li>
<p>
â€¢ SNR is a decreasing function of \(w_0\) .
</p>
</li>
</ul>
<p>
<span class="paragraph" id="autosec-215">What is the best value for \(w_0\)?</span>
<a id="poly-autopage-215"></a>

</p>

<ul style="list-style-type:none">

<li>
<p>
â€¢ With the maximum attenuation of 3dB constraint. \(\rightarrow \pause w_s\leq w_0 \leq \infty \).
</p>


</li>
<li>
<p>
â€¢ For \(w_0=w_{edf}\rightarrow R_{S/B}=\pause {2.76 dB}\)
</p>


</li>
<li>
<p>
â€¢ For \(w_0=(w_{edf}+w_s)/2={37*2*\pi }\rightarrow R_{S/B}=\pause {4.07dB}\)
</p>


</li>
<li>
<p>
â€¢ Pour \(w_0=w_{s}\rightarrow R_{S/B}=\pause {9.63dB}\)
</p>
</li>
</ul>

<p>
\(\rightarrow w_0=w_s\) respects the constraint and maximizes the SNR.

<p>

</p>
<p>
<span class="paragraph" id="autosec-216">Approximating a low pass filter </span>
<a id="poly-autopage-216"></a>

</p>
<div class="center" >

<p>

<a href="imgs/fourier/gabarit1.svg" target="_blank" ><img
    src="imgs/fourier/gabarit1.svg"
    style="
    width:455pt;
    "
    class="inlineimage"
    alt="(image)"
></a>
<a href="imgs/fourier/gabarit2.svg" target="_blank" ><img
    src="imgs/fourier/gabarit2.svg"
    style="
    width:455pt;
    "
    class="inlineimage"
    alt="(image)"
></a>
</p>
</div>
<p>
<span class="paragraph" id="autosec-218">Constraints for a low-pass filter</span>
<a id="poly-autopage-218"></a>

</p>
<ul style="list-style-type:none">

<li>
<p>
â€¢ Passband: \(1-\varepsilon \leq |\tilde H(w)| \leq 1 \quad \text {pour} \quad w&lt;w_p\)
</p>
<ul style="list-style-type:none">


<li>
<p>
â€“ \(w_p\): passing frequency.
</p>


</li>
<li>
<p>
â€“ \(\varepsilon \): passband margin parameter (\(\varepsilon =1/2\rightarrow -3dB\)).
</p>
</li>
</ul>
</li>
<li>
<p>
â€¢ Stopband : \(|\tilde H(w)| \leq \delta \quad \text {pour} \quad w&gt;w_a\)
</p>
<ul style="list-style-type:none">


<li>
<p>
â€“ \(w_a\): attenuation frequency.
</p>


</li>
<li>
<p>
â€“ \(\delta \): stopband margin parameter.
</p>
</li>
</ul>
</li>
<li>
<p>
â€¢ \(w_a-w_c\) is the transition band.
</p>
</li>
</ul>
<p>
<span class="paragraph" id="autosec-219">Additional constraints</span>
<a id="poly-autopage-219"></a>

</p>

<ul style="list-style-type:none">

<li>
<p>
â€¢ Need for an approximation function that respects the constraints <em>constrained optimization</em>.
</p>


</li>
<li>
<p>
â€¢ Criterion is optimized (for instance maximization of SNR).
</p>


</li>
<li>
<p>
â€¢ Two approaches are usually used:
</p>
</li>
</ul>
<p>
<span class="paragraph" id="autosec-220">Maximally flat frequency response</span>
<a id="poly-autopage-220"></a>

</p>
<ul style="list-style-type:none">

<li>
<p>
â€¢ Minimal distortion is achieved when the passband is flat.
</p>


</li>
<li>
<p>
â€¢ Let \(|\tilde H(w)|\) be the modulus of the frequency response of an order \(k\) filter.
</p>


</li>
<li>
<p>
â€¢ \(|\tilde H(w)|\) is <i>maximally flat</i> in \(w=0\) if all the \(K^{th}\)derivatives are null
</p>
</li>
</ul>

<p>
\[\frac {d^K|\tilde H(w)|}{dw^K}=0\]
</p>
<p>
<span class="paragraph" id="autosec-221">Equiripple filter</span>
<a id="poly-autopage-221"></a>

</p>
<ul style="list-style-type:none">

<li>
<p>
â€¢ A better rollof (sharper decrease) can be achieved at teh cost of oscillations.
</p>


</li>
<li>
<p>
â€¢ Oscilations can occur in the passband (leading to distortion) of cutband (limited attenuation).
</p>


</li>
<li>
<p>
â€¢ An equiripple filter has constant magnitude for its oscillations in the bandpass.
</p>
</li>
</ul>
<h6 id="autosec-222"><span class="sectionnumber" >3.4.1.3&#x2003;</span>Classical Analog Filters</h6>
<a id="poly-autopage-222"></a>
<p>
<span class="paragraph" id="autosec-223">Butterworth filter</span>
<a id="poly-autopage-223"></a>

</p>

<ul style="list-style-type:none">

<li>
<p>
â€¢ Butterworth filters are <em>maximally flat</em> [<a href="node-24.html#r2">Butterworth et&nbsp;al., 1930</a>].
</p>


</li>
<li>
<p>
â€¢ The amplitude of the frequency response can be expressed as   6cm
</p>
<p>
<span class="hidden" > \( \seteqsection {3} \) </span>     <span class="hidden" > \( \seteqnumber {23} \) </span>
</p>
<!--

                                                                                            1
                                                                           |HÌƒ(w)| =   q                                                                                                       (3.23)                          --><a id="eq:a_butter"></a><!--
                                                                                                w
                                                                                                     2n
                                                                                       1+       wc


-->
<p>


\begin{equation} \label {eq:a_butter} |\tilde H(w)|=\frac {1}{\sqrt {1+\left (\frac {w}{w_c}\right )^{2n}}} \end{equation}


</p>
<p>
with
</p>
<ul style="list-style-type:none">


<li>
<p>
â€“ \(n\): order of the filter.
</p>


</li>
<li>
<p>
â€“ \(w_c\): cutoff frequency.
</p>
</li>
</ul>
<p>
4cm
<a href="imgs/fourier/butterworth.svg" target="_blank" ><img
       src="imgs/fourier/butterworth.svg"
       style="
       width:506pt;
       "
       class="inlineimage"
       alt="(image)"
></a>
</p>


</li>
<li>
<p>
â€¢ The passing \(w_p\) and attenuation \(w_a\) frequencies are:        5.5cm For \(|\tilde H(w)|=1-\varepsilon \)
</p>
<p>
\[w_p=\pause { w_c\left (\frac {\varepsilon }{1-\varepsilon }\right )^{1/2n}}\]
</p>
<p>
5.5cm For \(|\tilde H(w)|=\delta \)
</p>
<p>
\[w_a=\pause {w_c\left (\frac {1-\delta }{\delta }\right )^{1/2n}}\]
</p>
<p>


</p>
</li>
</ul>

<ul style="list-style-type:none">

<li>
<p>
â€¢ The Butterworth filter is monotonically decreasing with the frequency.
</p>


</li>
<li>
<p>
â€¢ The amplitude of the frequency response can be expressed as
</p>
<p>
\[|\tilde H(w)|=1-\frac {1}{2}\left (\frac {w}{w_c}\right )^{2n}+\frac {3}{8}\left (\frac {w}{w_c}\right )^{4n}-\frac {5}{16}\left (\frac {w}{w_c}\right )^{6n}+\dots \]
</p>
</li>
<li>
<p>
â€¢ The derivative in \(w=0\) is then null up to order \(k=\pause 2n-1\).
</p>


</li>
<li>
<p>
â€¢ The frequency response of a (normalized) Butterworth filter can be expressed as \(\tilde H(w) =\frac {1}{B_n(w)}\) where \(B_n(w)\) is a Butterworth polynomial :
</p>
<p>
<span class="hidden" > \( \seteqsection {3} \) </span>     <span class="hidden" > \( \seteqnumber {24} \) </span>
</p>
<!--
                                                                                                                      (Q n                                            
                                                                                                                                                      2k+nâˆ’1
                                                                                                                         2
                                                                                                                         k=1
                                                                                                                               (jw))2 âˆ’ 2jw cos         2n
                                                                                                                                                                 Ï€ +1                  if n = even
                                                                                                     ,     Bn (w) =                   nâˆ’1                                        
                                                                                                                                                                 2k+nâˆ’1
                                                                                                                                  Q
                                                                                                                       (jw + 1)   k=1
                                                                                                                                       2
                                                                                                                                            (jw))2   âˆ’ 2jw cos     2n
                                                                                                                                                                            Ï€ +1       if n = odd

-->
<p>


\begin{equation*} \footnotesize , \quad B_n(w)= \begin {cases} \prod _{k=1}^{\frac {n}{2}} \left [(jw))^2-2jw\cos \left (\frac {2k+n-1}{2n}\,\pi \right )+1\right ] &amp;\mbox {if } n = \text { even} \\ (jw+1)\prod _{k=1}^{\frac {n-1}{2}} \left
[(jw))^2-2jw\cos \left (\frac {2k+n-1}{2n}\,\pi \right )+1\right ] &amp; \mbox {if } n = \text { odd} \end {cases} \end{equation*}


</p>
<table>
<tr class="hline" >
<td class="tdc tvertbarl tvertbarr" style="border-left:   1px solid black; border-right:   1px solid black">Order</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">Polynomial</td>
</tr>


<tr class="hline" >
<td class="tdc tvertbarl tvertbarr" style="border-left:   1px solid black; border-right:   1px solid black">1</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(1+jw\)</td>
</tr>


<tr>
<td class="tdc tvertbarl tvertbarr" style="border-left:   1px solid black; border-right:   1px solid black">2</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\((jw)^2+\sqrt {2}jw+1\)</td>
</tr>


<tr>
<td class="tdc tvertbarl tvertbarr" style="border-left:   1px solid black; border-right:   1px solid black">3</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\((jw+1)((jw)^2+jw+1)\)</td>
</tr>


<tr class="hline" >
<td class="tdc"></td>
<td class="tdc"></td>
</tr>
</table>
<div class="center" >
</div>
</li>
</ul>
<p>
<span class="paragraph" id="autosec-226">Chebyshev filter</span>
<a id="poly-autopage-226"></a>

</p>
<div class="center" >

<p>

<a href="imgs/fourier/cheby1.svg" target="_blank" ><img
    src="imgs/fourier/cheby1.svg"
    style="
    width:354pt;
    "
    class="inlineimage"
    alt="(image)"
></a><span style="width:28pt; display:inline-block"><!----></span>
<a href="imgs/fourier/cheby2.svg" target="_blank" ><img
    src="imgs/fourier/cheby2.svg"
    style="
    width:354pt;
    "
    class="inlineimage"
    alt="(image)"
></a>
</p>
</div>

<ul style="list-style-type:none">

<li>
<p>
â€¢ Better rolloff than Butterworth of same order but leads to oscillations in the bandpass (type 1) or in the stopband (type 2).
</p>


</li>
<li>
<p>
â€¢ <em>Equiripple</em> filter.
</p>


</li>
<li>
<p>
â€¢ Amplitude of the frequency response:    6cm
</p>
<p>
\[ |\tilde H(w)|=\frac {1}{\sqrt {1+\varepsilon ^2T_n^2\left (\frac {w}{w_c}\right )}}\]
</p>
<p>
5cm
</p>
<ul style="list-style-type:none">


<li>
<p>
â€“ \(T_n(\cdot )\): Chebyshev polynomial of order \(n\).
</p>
</li>
</ul>
</li>
</ul>
<h5 id="autosec-228"><span class="sectionnumber" >3.4.2&#x2003;</span>Filter implementation</h5>
<a id="poly-autopage-228"></a>


<p>
Implementation of the filter consist in finding the physical components that recovers the selected frequency response \(\tilde H(w)\).
</p>
<p>
<span class="paragraph" id="autosec-229">Passive filter</span>
<a id="poly-autopage-229"></a>

</p>
<ul style="list-style-type:none">

<li>
<p>
â€¢ Only passive components (R, C, L).
</p>


</li>
<li>
<p>
â€¢ No energy source, no amplification (conservation of energy).
</p>


</li>
<li>
<p>
â€¢ The input and output impedance has an effect on the frequency response (impedance matching).
</p>
</li>
</ul>
<p>
<span class="paragraph" id="autosec-230">Active filter</span>
<a id="poly-autopage-230"></a>

</p>
<ul style="list-style-type:none">

<li>
<p>
â€¢ Use an energy source and Operational Amplifiers (OA).
</p>


</li>
<li>
<p>
â€¢ OA has near infinite impedance but limited bandwidth (typically 100KHz).
</p>


</li>
<li>
<p>
â€¢ Saturation can occur (non-linearity).
</p>


</li>
<li>
<p>
â€¢ Stability can be a problem (due to feedback)
</p>
</li>
</ul>

<p>
Rarely use inductors in practice (price, resistance, space, mutual inductance) !
</p>
<p>
<span class="paragraph" id="autosec-231">Passive filters</span>
<a id="poly-autopage-231"></a>

</p>
<p>
<span class="paragraph" id="autosec-232">Example filter</span>
<a id="poly-autopage-232"></a>
7cm
</p>
<ul style="list-style-type:none">

<li>
<p>
â€¢ Brain-Computer Interface application.
</p>


</li>
<li>
<p>
â€¢ \(w_0=w_s=2\pi *12\)
</p>


</li>
<li>
<p>
â€¢ \(w_0=\frac {1}{RC}\rightarrow RC={\frac {1}{2*\pi *12}\approx 0.01326}\)
</p>


</li>
<li>
<p>
â€¢ What to choose for \(R\) and \(C\) ?
</p>


</li>
<li>
<p>
â€¢ Price and space constraints.
</p>
</li>
</ul>

<p>
5cm
</p>
<div class="center" >

<p>

<a href="imgs/fourier/RC2.svg" target="_blank" ><img
    src="imgs/fourier/RC2.svg"
    style="
    width:506pt;
    "
    class="inlineimage"
    alt="(image)"
></a>
</p>
</div>
<p>
<span class="paragraph" id="autosec-234">Filter transformation</span>
<a id="poly-autopage-234"></a>

</p>
<ul style="list-style-type:none">

<li>
<p>
â€¢ <b>low-pass \(\rightarrow \) high-pass</b>
</p>
<p>
\[ 1/jCw\rightarrow jLw \quad \text {et} \quad jLw \rightarrow 1/jCw\]
</p>
</li>
<li>
<p>
â€¢ <b>low pass \(\rightarrow \) band-pass</b>
</p>
<p>
\[ 1/jCw\rightarrow B/C(jw+1/jw) \quad \text {et} \quad jLw \rightarrow L/B/(jw+1/jw)\]
</p>
<p>


</p>
</li>
</ul>
<p>
<span class="paragraph" id="autosec-235">Butterworth Filter</span>
<a id="poly-autopage-235"></a>

</p>
<ul style="list-style-type:none">

<li>
<p>
â€¢ Corresponding frequency response with the Cauer topology.
</p>


</li>
<li>
<p>
â€¢ For an order \(n\) filter with cutoff frequency \(w_c=1\) the following structure:
</p>
<div class="center" >
<p>


<a href="imgs/fourier/Cauer_lowpass.svg" target="_blank" ><img
      src="imgs/fourier/Cauer_lowpass.svg"
      style="
      width:809pt;
      "
      class="inlineimage"
      alt="(image)"
></a>
</p>
</div>
<p>
With the values :
</p>
<ul style="list-style-type:none">


<li>
<p>
â€“ \(C_k=2\sin (\frac {2k-1}{2n}\pi )\) for \(k\) odd.
</p>


</li>
<li>
<p>
â€“ \(L_k=2\sin (\frac {2k-1}{2n}\pi )\) for \(k\) even.
</p>
</li>
</ul>
</li>
<li>
<p>
â€¢ Assuming the input and output have a \(1\) Ohm resistance.
</p>
</li>
</ul>
<p>
<span class="paragraph" id="autosec-237">Active filters</span>
<a id="poly-autopage-237"></a>

</p>
<p>
<span class="paragraph" id="autosec-238">First order active filter (with amplification)</span>
<a id="poly-autopage-238"></a>

</p>
<div class="center" >

<p>

<a href="imgs/fourier/filtrage_actif_1o.svg" target="_blank" ><img
    src="imgs/fourier/filtrage_actif_1o.svg"
    style="
    width:171pt;
    "
    class="inlineimage"
    alt="(image)"
></a>
</p>

<ul style="list-style-type:none">

<li>
<p>
â€¢ Frequency response
</p>
<p>
\[\tilde H(w)=\frac {A}{1+\frac {jw}{w_0}}\]
</p>
<p>
where
</p>
<p>
\[A=\pause {\frac {R_1+R_2}{R_1}} \quad \text {et} \quad w_0= \pause {\frac {1}{RC}}\]
</p>
</li>
<li>
<p>
â€¢ Parameters: \(R, C,R_1,R_2\)
</p>


</li>
<li>
<p>
â€¢ Permute \(R\) and \(C\) for a high-pass filter.
</p>
</li>
</ul>

</div>
<p>
<span class="paragraph" id="autosec-240">Second order active filter (Structure from [<a href="node-24.html#r18">Sallen and Key, 1955</a>]) </span>
<a id="poly-autopage-240"></a>

</p>
<div class="center" >

<p>

<a href="imgs/fourier/filtrage_actif_2o.svg" target="_blank" ><img
    src="imgs/fourier/filtrage_actif_2o.svg"
    style="
    width:809pt;
    "
    class="inlineimage"
    alt="(image)"
></a>
</p>
</div>

<ul style="list-style-type:none">

<li>
<p>
â€¢ Frequency response
</p>
<p>
\[\tilde H(w)=\frac {K}{1+\frac {2zjw}{w_n}+\frac {(jw)^2}{w_n^2}}\]
</p>
<p>
where
</p>
<p>
\[ w_n=\frac {1}{R\sqrt {C_1C_2}}\quad \text {et} \quad z=\sqrt {\frac {C_1}{C_2}} \frac {3-K}{2}\quad \text {et} \quad K=\frac {r_1+r_2}{r_1}\]
</p>
</li>
<li>
<p>
â€¢ Parameters: \(R, C_1,C_2,r_1,r_2\).
</p>
<p>


</p>
</li>
</ul>
<p>
<span class="paragraph" id="autosec-242">Analog filtering : mechanical filter</span>
<a id="poly-autopage-242"></a>

</p>
<p>
<span class="paragraph" id="autosec-243">Virgo Gravitational waves detector [<a href="node-24.html#r0">Acernese et&nbsp;al., 2014</a>]</span>
<a id="poly-autopage-243"></a>

</p>
<ul style="list-style-type:none">

<li>
<p>
â€¢ Interferometer to detect gravitational waves.
</p>


</li>
<li>
<p>
â€¢ Attenuate vibrations from the earth [<a href="node-24.html#r1">Braccini et&nbsp;al., 1996</a>]
</p>


</li>
<li>
<p>
â€¢ Objective : attenuations of \(10^{-9}\) for high frequencies.
</p>


</li>
<li>
<p>
â€¢ Use a mirror in a chamber with mechanical filters.
</p>


</li>
<li>
<p>
â€¢ Use a series of mechanical filters for the attenuation.
</p>


</li>
<li>
<p>
â€¢ Active correction for remaining low frequencies.
</p>
</li>
</ul>
<div class="center" >

<p>

<a href="imgs/fourier/virgo_mechanical_filter.png" target="_blank" ><img
    src="imgs/fourier/virgo_mechanical_filter.png"
    style="
    width:87pt;
    "
    class="inlineimage"
    alt="(image)"
></a>
<a href="imgs/fourier/virgo_mechanical_filter_response.png" target="_blank" ><img
    src="imgs/fourier/virgo_mechanical_filter_response.png"
    style="
    width:325pt;
    "
    class="inlineimage"
    alt="(image)"
></a>
</p>
</div>
<h5 id="autosec-245"><span class="sectionnumber" >3.4.3&#x2003;</span>Modulation</h5>
<a id="poly-autopage-245"></a>


<a id="sec:modulation"></a>
<h5 id="autosec-246"><span class="sectionnumber" >3.4.4&#x2003;</span>Fourier optics</h5>
<a id="poly-autopage-246"></a>


<a id="sec:"></a>

</section>

</div>

</div>

<footer>

<p>
<p><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/80x15.png" /> RÃ©mi Flamary, 2021</p>
</p>

</footer>


<nav class="botnavigation" ><a href="index.html" class="linkhome" >
Home</a></nav>

</body>
</html>
